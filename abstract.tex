\documentclass{eptcs}

\input{packages.tex}
\input{commands.tex}

\title{Equational Reasoning with Controlled ZXW Diagrams}
\author{
Edwin Agnew 
\and 
Lia Yeh
\and 
Richie Yeung
\and 
Matthew Wilson
}
\def\titlerunning{Equational Reasoning with Controlled ZXW Diagrams}
\def\authorrunning{E. Agnew, L. Yeh, R. Yeung, M. Wilson}
\begin{document}

\maketitle


The ZXW calculus is a newly developed graphical calculus for quantum computation which unifies the ZX and ZW calculi. The ZXW calculus consists of a set of rewrite rules which, thanks to a recent completeness result \cite{poor2023completeness}, can be used to prove equality between matrices of arbitrary dimension. The ZXW-calculus has already been applied to a number of areas including quantum chemistry \cite{shaikh2022sum}, quantum machine learning \cite{koch2022quantum} and photonics \cite{de2023light}. 

An important diagrammatic concept, introduced in \cite{shaikh2022sum} for aiding manipulation of Hamiltonians, is a \textit{controlled diagram} - a diagram extended with an additional input wire for triggering the operation on/off. In this work, we investigate the algebraic structure of controlled diagrams. Our results include:
\begin{enumerate}
    \item A lax monoidal functor mapping (square) matrices to their controlled diagram
    \item Controlled matrices form a ring, yielding powerful rewrite rules for large classes of diagrams
    \item Controlled states also form a ring, in this case isomorphic to the ring of multilinear polynomials. This gives rise to a novel entanglement detection algorithm and some connections between algebraic complexity theory and quantum circuit complexity. 
\end{enumerate}

\subsection*{Controlled Matrices}

The controlled diagram of a square matrix $D$ is the diagram $\tilde{D}$ such that:
\begin{equation*}
    \tikzfig{tikz/c_mat1} \qquad \tikzfig{tikz/c_mat2}
\end{equation*} 


Our first main result is showing that there is a lax monoidal functor $F$ mapping $D$ as follows.
\begin{equation*}
    F:: \tikzfig{tikz/F_def}
\end{equation*}


\subsection*{Controlled States}

Similar to square matrices, the controlled state of an $n$-partite state $|\psi\rangle$ is the diagram $\tilde{\psi}$ such that:
\begin{equation*}
    \tikzfig{tikz/c_state}
\end{equation*}

Controlled states form a ring with the following operations for addition and multiplication, respectively:
\begin{equation*}
    \tikzfig{tikz/cs_add_def} \qquad \tikzfig{tikz/cs_times_def}
\end{equation*}

A crucial part of proving this is the fact that, under suitable conditions, $\lowerbox{\coW}$ copies arbitrary controlled diagrams. This includes the case below, which holds for any square matrix $D$:
\begin{equation*}
    \tikzfig{tikz/c_dcopy}
\end{equation*}


Moreover, we exhibit an isomorphism to the ring of multilinear polynomials. An arbitrary polynomial $p = a_0 + a_1x_n + ... + a_{2^n-1}x_1x_2...x_n$ is represented as:

\begin{equation*}
    \tikzfig{tikz/pnf} ~=~ 
        \begin{bmatrix}
            1 &  a_0 \\ 0 & a_1 \\ ... & ... \\ 0 & a_{2^n-1}
        \end{bmatrix}
\end{equation*}

Conversely, any controlled state built from $\lowerbox[7]{\wspids}$, $\lowerbox[7]{\zspids}$, $\lowerbox{\coW}, \numberstate$ (which we call an arithmetic ZXW diagram) can be immediately interpreted as a polynomial. The specific form of the diagram above (which we call polynormal form) is closely related to the normal form used in the proof of completeness for the ZXW calculus \cite{poor2023completeness} and is universal. Thus any $n$-partite qubit state can be interpreted as an $n$-linear polynomial and quantum operations can be interpreted as operations on polynomials.


%\subsection*{Applications}

%\subsubsection*{Control semantics}

%\subsubsection*{Hamiltonians}

%\subsubsection*{Entanglement detection}

%Thanks to our polynomial isomorphism theorem, it turns out that separability of a pure state $\psi$ is equivalent to being able to factor $p_{\psi}$ (the corresponding polynomial) into distinct subsystems.

%\begin{equation*}
%    \tikzfig{tikz/sep}
%\end{equation*}

%Thus entanglement detection reduces to polynomial factorisation, for which efficient algorithms exist \cite{forbes2015complexity}. 


%\subsubsection*{Algebraic Complexity Theory}

%By universality of arithmetic ZXW diagrams, it is possible to translate any quantum circuit into an algebraic circuit. This opens up the possibility for much cross-pollination between quantum circuit complexity and algebraic complexity. Nevertheless, we give strong counter-evidence for the efficiency of this translation, via a reduction to polynomial identity testing.
%\begin{prop*}
%    If translating a quantum circuit to an arithmetic diagram can be done in polynomial time, then $\mathsf{NQP} = \mathsf{RP}$
%\end{prop*}

%Since $\mathsf{RP} \subseteq \mathsf{NP} \subseteq \mathsf{NQP}$, this implies that $\mathsf{RP} \subseteq \mathsf{NP}$ which is unlikely since most complexity theorists believe $\mathsf{P} = \mathsf{RP} \neq \mathsf{NP}$.


\bibliographystyle{acm}
\bibliography{refs}



\end{document}
