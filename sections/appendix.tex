\section{ZXW rules}\label{sec:apprules}


\textbf{ZX Rules}:

\begin{gather}
  \tikzfig{tikz/axioms/s1}
  \tag{S1}\label{rule:S1}
\end{gather}
\begin{multicols}{2}
  \noindent
  \begin{gather*}
    \tikzfig{tikz/axioms/s2}
    \tag{S2}\label{rule:S2}
    \neweqline
    \tikzfig{tikz/axioms/rdotaemptydit0}
    \tag{Ept}\label{rule:Ept}
    \neweqline
    \tikzfig{tikz/axioms/b2}
    \tag{B2}\label{rule:B2}
    \neweqline
    \tikzfig{tikz/axioms/k0copy}
    \tag{K0}\label{rule:K0} 
  \end{gather*} \columnbreak
  \begin{gather*}
    \tikzfig{tikz/axioms/pimultiplecpdit}
    \tag{K1}\label{rule:K1}
    \neweqline
    \tikzfig{tikz/axioms/k2adit}
    \tag{K2}\label{rule:K2}
    \neweqline
    \tikzfig{tikz/axioms/zerotoreddit0}
    \tag{Zer}\label{rule:Zer}
    \neweqline
    \tikzfig{tikz/axioms/h_id}
    \tag{H}\label{rule:H} 
  \end{gather*}
\end{multicols}

Where $k \in \{0, 1\}$. 


\bigskip

\textbf{ZW Rules}:

\begin{multicols}{2}
  \noindent
  \begin{gather*}
    \tikzfig{tikz/axioms/phasecopydit}
    \tag{Pcy}\label{rule:Pcy}\neweqline
    \tikzfig{tikz/axioms/wsymetrydit}
    \tag{Sym}\label{rule:Sym}\neweqline
    \tikzfig{tikz/axioms/w-bialgebra}
    \tag{BZW}\label{rule:BZW}
    \end{gather*} \columnbreak
    \begin{gather*}
    \tikzfig{tikz/axioms/additiondit}
    \tag{ADD}\label{rule:ADD}\neweqline
    \tikzfig{tikz/axioms/associatedit}
    \tag{Aso}\label{rule:Aso}\neweqline
    \tikzfig{tikz/axioms/w-w-algebra}
    \tag{WW}\label{rule:WW}
  \end{gather*}
\end{multicols}


\bigskip

\textbf{ZXW Rules}:

\begin{multicols}{2}
  \noindent
  \begin{gather*}
    \tikzfig{tikz/axioms/triangleocopydit}
    \tag{Bs0}\label{rule:Bs0}\neweqline
    \tikzfig{tikz/axioms/trianglepicopydit2}
    \tag{Bsj}\label{rule:Bsj}\neweqline
    \tikzfig{tikz/axioms/trialgebra}
    \tag{TA}\label{rule:TA}\neweqline
    \tikzfig{tikz/axioms/hadamard-decomposition2}
    \tag{HD}\label{rule:HD}
    \end{gather*}
\end{multicols}

\section{Basic Lemmas}\label{sec:applem}

The following two lemmas follow immediately from the bra-ket definition of $\lowerbox{\wspid}$:
\begin{lemma}
    \begin{equation}\label{eq:wid}
        \tikzfig{tikz/lemmas/wid}
    \end{equation}
\end{lemma}

\begin{lemma}
    \begin{equation}\label{eq:wont}
        \tikzfig{tikz/lemmas/wont}
    \end{equation}
\end{lemma}


\begin{lemma}
    \begin{equation}\label{eq:xcpy}
        \tikzfig{tikz/lemmas/xcpy_statement}
    \end{equation}
    \end{lemma}
    \begin{proof}
        \begin{equation*}
        \tikzfig{tikz/lemmas/xcpy}
    \end{equation*}
    \end{proof}
  
  
  
  \begin{lemma}
      \begin{equation}\label{eq:zerobox}
          \tikzfig{tikz/lemmas/zerobox_statement}
      \end{equation}
  \end{lemma}
  \begin{proof}
      \begin{equation*}
          \tikzfig{tikz/lemmas/zerobox}
      \end{equation*}
  \end{proof}
  
  \begin{lemma}
      \begin{equation}\label{eq:cp_add}
          \tikzfig{tikz/lemmas/cpadd_statement}
      \end{equation}
  \end{lemma}
  \begin{proof}
      \begin{equation*}
      \tikzfig{tikz/lemmas/cpadd}
  \end{equation*}
  \end{proof}
  
  \begin{lemma}
    \begin{equation}\label{eq:x-x=0}
      \tikzfig{tikz/lemmas/cp_add2_statement}
    \end{equation}
  \end{lemma}
  \begin{proof}
    \begin{equation*}
        \tikzfig{tikz/lemmas/cp_add2}
    \end{equation*}
  \end{proof}
  
  
  \begin{lemma}
    \begin{equation}\label{eq:cpk_add}
      \tikzfig{tikz/lemmas/cpk_add_statement}
    \end{equation}
  \end{lemma}
  \begin{proof}
    \begin{equation*}
      \tikzfig{tikz/lemmas/cpk_add}
    \end{equation*}
  \end{proof}
  
  
  \begin{lemma}{}{}
    \begin{equation}\label{eq:kill_quad}
    \tikzfig{tikz/lemmas/kill_quad_statement}
  \end{equation}
  \end{lemma}
  \begin{proof}
    \begin{equation*}
        \tikzfig{tikz/lemmas/kill_quad}
    \end{equation*}
  \end{proof}
  
  
  \begin{lemma}
    \begin{equation}\label{eq:dbl_dist}
    \tikzfig{tikz/lemmas/dbl-dist-statement}
  \end{equation}
  \end{lemma}
  \begin{proof}
    \begin{equation*}
    \tikzfig{tikz/lemmas/dbl-dist}
  \end{equation*}
  \end{proof}
  
  \begin{lemma}
    \begin{equation}\label{eq:dist_circ}
      \tikzfig{tikz/lemmas/dist_statement}
    \end{equation}
  \end{lemma}
  \begin{proof}
    \begin{equation*}
      \tikzfig{tikz/lemmas/dist}
    \end{equation*}
  \end{proof}
  
  
  %TODO: find proofs!
  
  %\begin{equation}\label{eq:wid}
  %    \tikzfig{tikz/lemmas/wid}
  %\end{equation}
  
  
  %\begin{equation}\label{eq:wont}
  %  \tikzfig{tikz/lemmas/wont}
  %\end{equation}
  
  
  
  
  
  \begin{lemma}
    \begin{equation}\label{eq:0times}
        \tikzfig{tikz/lemmas/0times_statement}
    \end{equation}
  \end{lemma}
  \begin{proof}
    \begin{equation*}
        \tikzfig{tikz/lemmas/0times}
    \end{equation*}
  \end{proof}

\section{Main Proofs}\label{sec:appiso}

\textbf{Proof of Proposition \ref*{prop:and}}

\begin{proof}
    We can verify this computes the AND gate by computing on basis states.
    \begin{equation}\label{eq:and1}
        \tikzfig{tikz/func/and1}
    \end{equation}
    Thus $AND(1, x) = x$. Since the diagram is clearly commutative, it remains to check $AND(0, x) = 0$.
    \begin{equation}\label{eq:and0}
        \tikzfig{tikz/func/and0}
    \end{equation}
\end{proof}

\textbf{Proof of Lemma \ref*{lem:csq_copy}}
\begin{proof}
    First of all, using (\ref{rule:BZW}) we can rewrite the LHS to
    \begin{equation*}
        \tikzfig{tikz/con/csq_dcopy2}
    \end{equation*}

    Then clearly 
    \begin{equation*}
        \tikzfig{tikz/con/csq_dcopy3}
    \end{equation*}

    Meanwhile, 
    \begin{equation*}
        \tikzfig{tikz/con/csq_dcopy4}
    \end{equation*}

    Thus the two sides are equal over the Z basis and so are equal as diagrams.
\end{proof}

\textbf{Proof of Lemma \ref*{lem:csq_add_comm}}
\begin{proof}
    We prove by plugging red and commutativity of matrix addition. By definition of controlled matrices, plugging $\lowerbox{\redzero}$ gives $I_n$ on both sides. Meanwhile, plugging $\lowerbox{\redpi}$ gives:
    \begin{equation*}
       \tikzfig{tikz/con/csq_add_comm}
   \end{equation*}
\end{proof}

\textbf{Proof of Lemma \ref*{lem:csq_dist}}
\begin{proof}
    \begin{equation*}
        \tikzfig{tikz/con/csq_dist}
    \end{equation*}
\end{proof}

\textbf{Proof of Lemma \ref*{lem:cs_copy}}
\begin{proof}
    As before, plugging $|0\rangle$ gives
    \begin{equation*}
        \tikzfig{tikz/con/cs_copy1}
    \end{equation*}

    Meanwhile, plugging $|1\rangle$ gives
        \begin{equation*}
        \tikzfig{tikz/con/cs_copy2}
    \end{equation*}

    Completing the proof
\end{proof}

\textbf{Proof of Lemma \ref*{lem:cs_add_comm}}
\begin{proof}
    \tikzfig{tikz/con/cs_add_comm}
\end{proof}

\textbf{Proof of Lemma \ref*{lem:cs_add_id}}
\begin{proof}
    It is clear that $\lowerbox[10]{\zeroproj}$ is the controlled state $\tilde{\mathbf{0}}$. 
    
    Then we have:
    \begin{equation*}
        \tikzfig{tikz/con/cs_add_id}
    \end{equation*}

\end{proof}

\textbf{Proof of Lemma \ref*{lem:cs_add_inv}}
\begin{proof}
    $\tilde{\psi} \circ \raisebox{-5pt}{\numbergate[-1]}$ is still a controlled state since $\raisebox{-5pt}{\numbergate[-1]}$ does nothing to $\raisebox{-5pt}{\redzero}$. Then $\tilde{\psi} \circ \raisebox{-5pt}{\numbergate[-1]}$ inverts $\tilde{\psi}$ since:
    \begin{equation*}
        \tikzfig{tikz/con/cs_add_inv}
    \end{equation*}
\end{proof}

\textbf{Proof of Lemma \ref*{lem:cs_add_inv}}
\begin{proof}
    \begin{gather*} %\label{eq:cs_dist}
        \tilde{\psi_1} \boxtimes (\tilde{\psi_2} \boxplus \tilde{\psi_3}) ~=~ \tikzfig{tikz/distproof/d1} ~
        \eqq{\ref{rule:BZW}} ~ \tikzfig{tikz/distproof/d2} \neweqline ~=~ \tikzfig{tikz/distproof/d3} ~
        \eqq{\ref{eq:cs_copy}} ~ \tikzfig{tikz/distproof/d4} \neweqline ~=~ \tikzfig{tikz/distproof/d5}
        ~=~ \tikzfig{tikz/distproof/d6} \neweqline ~=~ (\tilde{\psi_1} \boxtimes \tilde{\psi_2}) \boxplus (\tilde{\psi_1} \boxtimes \tilde{\psi_3})
    \end{gather*} 

\end{proof}


\textbf{Proof of Proposition \ref*{prop:vec_pnf}}
\begin{proof}
    We prove by induction on $n$.
    
    For the base case, $n=0$. The only PNF with no outputs is a number so we have: $$\numberstate[a_0] = \begin{bmatrix}
        1 & a_0
    \end{bmatrix}$$ as desired.
    
    For inductive hypothesis, we assume that (\ref{eq:pnf_vec}) holds for every PNF on $n$ outputs. We use this hypothesis to extend it to PNFs with $n+1$ outputs. 
    
    Let $D$ be an arbitrary PNF with $n+1$ outputs. Firstly, observe that $x_{n+1}$ is connected to only the odd coefficients $\{a_{2k+1}\}$ since these are exactly the indices with $1$ in the least significant bit. Thus we can rewrite:
    \begin{gather*}
        \raisebox{-20pt}{\ddiag} ~=~ \tikzfig{tikz/poly/lemmas/uni10} \neweqline ~=~ \tikzfig{tikz/poly/lemmas/uni11} \neweqline ~\eqq{\ref{rule:BZW}}~ \tikzfig{tikz/poly/lemmas/uni12} \neweqline 
        ~=~ \tikzfig{tikz/poly/lemmas/uni13}
    \end{gather*}
    Where $D_{even}, D_{odd}$ are PNF diagrams. Since they are over $n$ variables, we can apply the inductive hypothesis and obtain:
    \begin{equation}\tag{*}
        D_{even} = \begin{bmatrix}
            1 & a_0 \\ 0 & a_2 \\ ... & ... \\ 0 & a_{2^{n+1}-2}
        \end{bmatrix}, 
        D_{odd} = \begin{bmatrix}
            1 & a_1 \\ 0 & a_3 \\ ... & ... \\ 0 & a_{2^{n+1}-1}
        \end{bmatrix}
    \end{equation}


    Next, plugging red we observe:
    \begin{equation*}
        \tikzfig{tikz/poly/lemmas/uni2}
    \end{equation*}
    Meanwhile,
    \begin{equation*}
        \tikzfig{tikz/poly/lemmas/uni3}
    \end{equation*}

    Summing these together,
    \begin{gather*}
        \tikzfig{tikz/poly/lemmas/uni4}
        \neweqline ~=~ (D_{even} \otimes \ketz) + (D_{odd}\keto \brao \otimes  \keto) \neweqline \eqq{*}~ \begin{bmatrix}
            1 & a_0 \\ 0 & a_2 \\ ... & ... \\ 0 & a_{2^{n+1}-2}
        \end{bmatrix} \otimes \ketz + \begin{bmatrix}
            0 & a_1 \\ 0 & a_3 \\ ... & ... \\ 0 & a_{2^{n+1}-1}
        \end{bmatrix} \otimes \keto  \neweqline
        ~=~ \begin{bmatrix}
            1 & a_0 \\ 0 & 0 \\ 0 & a_2 \\ 0 & 0 \\ ... & ... \\ 0 & a_{2^{n+1}-2} \\ 0 & 0
        \end{bmatrix} + \begin{bmatrix}
            0 & 0 \\ 0 & a_1 \\ 0 & 0 \\ 0 & a_3 \\ ... & ... \\ 0 & 0 \\ 0 & a_{2^{n+1}-1}
        \end{bmatrix} 
        ~=~ \begin{bmatrix}
            1 & a_0 \\ 0 & a_1 \\ 0 & a_2 \\ 0 & a_3 \\ ... & ... \\ 0 & a_{2^{n+1}-2} \\ 0 & a_{2^{n+1} -1}
        \end{bmatrix}
    \end{gather*}

    Completing the inductive step.
\end{proof}

\textbf{Proof of Theorem \ref*{thm:uni_pnf}}

\begin{proof}
    Let $A$ be an arithmetic diagram. If $A = \numberstate$, we are done. 
    
    Otherwise, $A$ has at least one output. First, we shall rewrite $A$ into three layers, consisting of: (1) a single W at the top, (2) a layer of $\raisebox{-5pt}{\zspids}$ and (3) a layer of $\numberstate$'s and $\raisebox{-5pt}{\coWs}$'s. Then we shall collect terms and order the boxes to produce a PNF. 

    If the top of $A$ is not already $\raisebox{-5pt}{\wspids}$, it must be $\raisebox{-5pt}{\zspids}$. It cannot be $\numberstate$ since the remaining arithmetic diagram would then have no inputs which is impossible. It cannot be $\raisebox{-5pt}{\coWs}$ since there is only one input and arithmetic diagrams cannot contain $\ccap$. Thus we can rewrite:
    \begin{enumerate}[label={(\arabic*)}]
    \item $\tikzfig{tikz/poly/lemmas/algtop1}$
    \end{enumerate}

    (1) guarantees there is a W at the top. We shall now repeatedly apply rewrites underneath the W until there are exactly three layers. Assume that fusion is applied as much as possible between each stage and (\ref{eq:kill_quad}) is applied and simplified with (\ref{rule:K0}) to remove $\raisebox{-8pt}{\xsq}$ whenever possible. Then for as long as there are at least 4 layers, we can apply one of the following rewrites:
        \begin{enumerate}[resume, label={(\arabic*)}]
            \item $\tikzfig{tikz/poly/lemmas/algcases1}$
            \item $\tikzfig{tikz/poly/lemmas/algcases2}$
            \item $\tikzfig{tikz/poly/lemmas/algcases3}$
            \item $\tikzfig{tikz/poly/lemmas/algcases4}$
            \item $\tikzfig{tikz/poly/lemmas/algcases5}$
        \end{enumerate}

    \medskip
    
    Clearly, we can only stop applying these rules once $A$ is a sum of products of copies. Steps (2) and (3) ensure the top of $A$ has such a structure and steps (4) - (6) ensure that there is nothing beneath the $\lowerbox{\coWs}$'s . To see that this will always terminate, observe that (2) and (3) preserve the depth of $A$ while (4), (5), (6) all decrease it. (2) and (3) can only be applied a finite number of times before another simplification must be used. So repeatedly applying these rewrites must eventually shrink the depth down to $3$, as desired. Finally, to put $A$ in PNF we must:
    \begin{enumerate}[resume, label={(\arabic*)}]
        \item Collect terms: whenever there are two boxes connected to exactly the same set of $\raisebox{-5pt}{\coWs}$'s, use (\ref{eq:cpk_add}) to fuse them together. 
        \item Pad: use (\ref{eq:zerobox}) to insert $\raisebox{-5pt}{\numbergate[0]}$ for any connectivities that do not exist in $A$.
        \item Reorder: use (\ref{rule:Sym}) to reorder coefficients into the canonical order.
    \end{enumerate}

    Step (7) ensures that every $\raisebox{-5pt}{\zspids}$ has unique connectivity. Step (8) ensures there are exactly $2^n$ coefficients so that step (9) can order them in the appropriate way. 

    Thus $A$ has been written in PNF, completing the proof.
    

\end{proof}


\textbf{Proof of Theorem \ref*{thm:iso}}
\begin{proof}
    
    First, we show $\phi_n$ is a homomorphism, i.e. \begin{equation*}
        \forall p, q \in \polyring, \phi_n(p + q) = \phi_n(p) \boxplus \phi_n(q) ,\quad \phi_n(p \times q) = \phi_n(p) \boxtimes \phi_n(q)
    \end{equation*} The strategy for the proof will be an induction on $n$. 

    \medskip
    
    \textbf{Base case:}
    We have not defined controlled states for $n=0$, so the base case begins with $n=1$.
    Let $p, q \in \polyring[1]$. Write as $p(x_1) = a_0 + a_1x_1, q(x_1) = b_0 + b_1x_1$, where $a_0, a_1, b_0, b_1 \in \mathbb{C}$. Then since $p + q = a_0 + b_0 + (a_1 + b_1)x_1$,
    \begin{equation*}
        \tikzfig{tikz/poly/homproof/hombaseadd}
    \end{equation*}

    Meanwhile, since $p \times q = a_0a_1 + (a_0b_1 + a_1b_0)x_1$, 
    \begin{gather*}
        \phi_1(p) \boxtimes \phi_1(q) ~=~ \tikzfig{tikz/poly/homproof/bt1} ~\eqq{\ref{eq:dbl_dist}}~ \tikzfig{tikz/poly/homproof/bt2} \neweqline 
        ~\eqq{\ref{eq:dist_circ}}~ \tikzfig{tikz/poly/homproof/bt3} ~\eqq{\ref{rule:Pcy}}~ \tikzfig{tikz/poly/homproof/bt4} \neweqline
        ~\eqq{\ref{eq:kill_quad}}~ \tikzfig{tikz/poly/homproof/bt5} ~\eqq{\ref{eq:0times}}~ \tikzfig{tikz/poly/homproof/bt6} ~\eqq{\ref{eq:cp_add}}~ \tikzfig{tikz/poly/homproof/bt7} \neweqline ~= \phi_1(p \times q)
    \end{gather*}


    Completing the base case.

    \medskip


    \textbf{Inductive step:}

    Let $Hom(n)$ assert than $\phi_n$ is a homomorphism.  Then for the inductive step we wish to prove that $\forall n, Hom(n) \implies Hom(n+1)$.

    The proof relies on the recursive definition of $R[x_1, x_2] = R[x_1][x_2]$, for any ring $R$, to rewrite an arbitrary polynomial $p(x_1, ..., x_{n+1}) = a_0 + a_1x_{n+1} + ... + a_{2^{n+1}-1}x_1x_2...x_{n+1} \in \polyring[n+1]$ as $p(x_{n+1}) = p_0 + p_1x_{n+1}$, where $p_0, p_1 \in \polyring$. This allows the $p_i$ to be treated similarly to the scalars in the base case. To emphasise this, they will be drawn in green boxes. To help distinguish when an operation is covered by the inductive hypothesis, the wires for variables $x_1, ..., x_n$ will be drawn in light blue, while the $x_{n+1}$ wires will be drawn in black. Thus the inductive hypothesis states that:
    \begin{equation}\label{eq:ih1}\tag{IH1}
        \tikzfig{tikz/poly/homproof/ih1}
    \end{equation}
    \begin{equation}\label{eq:ih2}\tag{IH2}
        \tikzfig{tikz/poly/homproof/ih2}
    \end{equation}

    Let $p(x_{n+1}) = p_0 + p_1x_{n+1}, q(x_{n+1}) = q_0 + q_1x_{n+1}$, where $p_0, p_1, q_0, q_1 \in \polyring$. Then for addition:
    \begin{gather*}
        \phi_{n+1}(p) \boxplus \phi_{n+1}(q) ~=~ \tikzfig{tikz/poly/homproof/sa1} ~\eqq{\ref{rule:Aso}}~ \tikzfig{tikz/poly/homproof/sa2} \neweqline
        ~ \eqq{IH1} ~ \tikzfig{tikz/poly/homproof/sa3} ~\eqq{\ref{rule:BZW}}~ \tikzfig{tikz/poly/homproof/sa4} ~\eqq{IH1}~ \tikzfig{tikz/poly/homproof/sa5} \neweqline
        ~=~ \phi_{n+1}(p_0 + q_0 + (p_1 + q_1)x_{n+1}) ~=~ \phi_{n+1}(p + q)
    \end{gather*}


    Similarly, for multiplication:
    \begin{gather*}
    \phi_{n+1}(p) \boxtimes \phi_{n+1}(q) ~=~ \tikzfig{tikz/poly/homproof/st1} \eqq{\ref{eq:dbl_dist}}  ~ \tikzfig{tikz/poly/homproof/st2} \neweqline
    \eqq{\ref{eq:cs_copy}} ~ \tikzfig{tikz/poly/homproof/st3} \eqq{\ref{eq:ih2}} ~ \tikzfig{tikz/poly/homproof/st4} \neweqline
    \eqq{\ref{rule:BZW}} ~ \tikzfig{tikz/poly/homproof/st5} ~ = ~ \tikzfig{tikz/poly/homproof/st6} \neweqline
     \eqq{\ref{eq:cs_copy}} ~ \tikzfig{tikz/poly/homproof/st7} ~ \eqq{\ref{eq:ih2}} ~ \tikzfig{tikz/poly/homproof/st8} \neweqline
    \eqq{\ref{rule:BZW}} ~ \tikzfig{tikz/poly/homproof/st9} ~ = ~ \tikzfig{tikz/poly/homproof/st10} \neweqline
    \eqq{\ref{eq:kill_quad}} ~ \tikzfig{tikz/poly/homproof/st11} ~ \eqq{\ref{eq:arith_cs}, \ref{eq:wid}} ~ \tikzfig{tikz/poly/homproof/st12} \neweqline ~ \eqq{\ref{eq:ih2}} ~ \tikzfig{tikz/poly/homproof/st13}
      ~ \eqq{\ref{rule:BZW}} ~ \tikzfig{tikz/poly/homproof/st14} ~ \eqq{\ref{eq:ih1}} ~ \tikzfig{tikz/poly/homproof/st15} \neweqline
     ~=~ \phi_{n+1}(p_0q_0 + (p_0q_1 + p_1q_0)x_{n+1} )
     ~=~ \phi_{n+1}(p \times q)
    \end{gather*}

    \medskip

    This completes the inductive step, proving that $\forall n > 1$, $\phi_n$ is a homomorphism.

    \bigskip

    Finally, to see $\phi_n$ is an isomorphism, we use Theorem \ref{thm:uni_pnf} to write an arbitrary controlled state in PNF:
    \begin{gather*}
        \begin{bmatrix}
            1 & a_0 \\ 0 & a_1 \\ ... & .. \\ 0 & a_{2^{n}-1}
        \end{bmatrix}
        = \tikzfig{tikz/poly/pnf}
    \end{gather*}

    Then all we have to do is interpret it as the image of a polynomial:
    \begin{gather*}
        \tikzfig{tikz/poly/pnf} ~=~ \tikzfig{tikz/poly/homproof/iso4} \neweqline ~=~ \phi_{n}(a_0) + \phi_{n}(a_1x_{n}) + ... + \phi_{n}(a_{2^{n}-1x_1x_2...x_{n}}) \neweqline ~=~ \phi_{n}(a_0 + a_1x_{n} + ... + a_{2^{n}-1}x_1x_2...x_{n}) 
    \end{gather*}
\end{proof}