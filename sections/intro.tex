\section{Introduction}
Controlling or branching to different possible linear maps, relations, or channels is important across quantum information and quantum computation, and has been studied through many different approaches. In quantum algorithms common techniques are block encodings~\cite{gilyen2019qsvt, rall2020qalgsblockenc} and linear combination of unitaries~\cite{childs2012hamsimlcu}, while a number of formalisations have included routed quantum circuits~\cite{vanrietvelde2021routed}, the many-worlds calculus~\cite{chardonnet2023manyworlds}, categorifying signal flow diagrams~\cite{baez2015categoriesctrl}, and classical and quantum control in quantum modal logic~\cite{sati2023quantummonadology}.

The question we are interested in is how quantum graphical calculi such as the ZX~\cite{coecke2011zx}, ZW~\cite{coecke2010zw}, and ZH~\cite{backens2019zh} calculus can be augmented to support properties of quantum control.
An early use of controlled state diagrams was for proving constructive and rational angle ZX calculus completeness~\cite{jeandel2018zxconstructive}. More recently, controlled state and controlled matrix diagrams have been applied to addition and differentiation of ZX diagrams~\cite{jeandel2024adddiffzx}, differentiating and integrating ZX diagrams for quantum machine learning~\cite{wang2022diffintzx}, Hamiltonian exponentiation and simulation~\cite{shaikh2022sum}, non-linear optical quantum computing~\cite{de2023light}, and fermion-to-qubit mappings~\cite{mcdowallrose2025f2q}. To sum ZX diagrams, these works have used controlled states along with the W generator from the ZW calculus.

Given how useful controlled diagrams are, a natural question to ask is why they work: What their underlying mathematical structures are, and which equational rewrites they satisfy.
Before descending into the details, we present the relationship between controlled matrices, and the conventional notion of quantum controlled gates. We show how to recover the latter from the former, through the higher-order map $\Control$ that maps square matrices to controlled square matrices.

First of our main results, we show that the set of all controlled $n$-partite states defines a commutative ring. We introduce $\boxplus$ which defines an Abelian group and $\boxtimes$ which defines a commutative monoid, and show that $\boxtimes$ distributes over $\boxplus$. The fragment of the qubit ZW calculus corresponding to controlled states, which we call \emph{arithmetic diagrams} hence defines a ring which we prove is isomorphic to multilinear polynomials $\mathbb{C}[x_1,...,x_n]/({x_1}^2,...,{x_n}^2)$. We prove completeness for all operations in this ring by an algorithm to rewrite any arithmetic diagram to what we call \emph{polynormal form (PNF)}. Likewise, we show that the set of all controlled square matrices on $n$ qubits defines a non-commutative ring $(\tilde{M^n}, \lowerbox[10]{\wspids}, \lowerbox[10]{\zspids})$, and a second completeness result for this ring.

To the qubit ZXW-calculus, whose completeness for arbitrary finite dimension was proven in Ref.~\cite{poor2023completeness}, we add controlled states and controlled square matrices as new generators, along with the rewrite rules for completeness over their rings.
Now in the same calculus, we plug controlled states into each control wire of controlled square matrices, and show using only the rewrite rules so far that this is isomorphic to multivariate polynomials over same-size square matrices. Commutativity of controlled square matrices holds in the special case that the controls target mutually exclusive sectors, allowing copying of arbitrary controlled diagrams. As a result, we can factor multivariate polynomials over same-size square matrices. This third completeness result means we now have the ability to factor any Hamiltonian in the ZXW-calculus~\cite{shaikh2022sum}, even with all its terms black-boxed.
In sum, these algebraic properties of quantum control give rise to powerful new graphical reasoning capabilities.