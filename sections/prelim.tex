\section{Preliminaries}

This section introduces the ZXW-calculus, and how controlled diagrams are defined in it. The ZXW-calculus is a graphical formalism for qudit computation, unifying the ZX and ZW calculi and synthesising their relative strengths. The ZXW-calculus consists of diagrams built from a small number of generators and equipped with a complete set of rewrite rules, which enables all equalities between linear maps to be proven diagrammatically.  Diagrams are to be read top to bottom and left to right.

\subsection{The ZXW-Calculus}
%%% some intro about the zxw-calculus, specifically some applications/citations and the explaining the completeness results, should go here.
The qubit ZXW-calculus is built from the following generators:

\begin{gather}
  \left\llbracket \quad \lowerbox{\idwire[0.5]} \;\;\; \right\rrbracket ~=~ \begin{bmatrix}1 & 0 \\ 0 & 1\end{bmatrix} \quad
  \left\llbracket \; \lowerbox[10]{\swap[0.4]} \; \right\rrbracket ~=~ \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1\end{bmatrix} \quad
  \Big\llbracket \; \lowerbox[3]{\ccap} \; \Big\rrbracket ~=~ \begin{bmatrix} 1 \\ 0 \\ 0 \\ 1\end{bmatrix} \quad
  \left\llbracket \; \lowerbox[5]{\ccup} \; \right\rrbracket ~=~ \begin{bmatrix} 1 & 0 & 0 & 1 \end{bmatrix} \\
  \left\llbracket \;\; \tikzfig{tikz/defs/zspid} \;\; \right\rrbracket ~=~ |0^m\rangle\langle0^n| + c|1^m\rangle\langle1^n|, c \in \mathbb{C} \qquad
  \left\llbracket \;\; \raisebox{-10pt}{\wspid[0.7]} \;\; \right\rrbracket ~=~ |00\rangle \braz + |01\rangle \brao + |10\rangle \brao \\
  \left\llbracket \;\;\; \raisebox{-8pt}{\hgate} \;\; \right\rrbracket = \frac{1}{\sqrt{2}}\begin{bmatrix}1 & 1 \\ 1 & -1\end{bmatrix}
\end{gather}

For simplicity, we introduce the following additional notation:

\begin{gather}
  \tikzfig{tikz/defs/zcirc}\\
  \tikzfig{tikz/defs/xcirc}\qquad \qquad \qquad \qquad
  \raisebox{-10pt}{\coWs[0.7]} ~:=~ \tikzfig{tikz/defs/w_trans}
\end{gather}

Equations in ZXW apply diagrammatic rewrite rules which prove equalities of the underlying matrices. Omitted from Figure~\ref{fig:zxw_rules} are the \emph{structural rules} ubiquitous to quantum graphical calculi, such as that swapping twice yields the two-qubit identity and that an S-shaped cup and cap pair yields the one-qubit identity. These collectively are referred to as the \emph{Only Connectivity Matters} rule, which governs that in this calculus the following operations preserve semantic equality: So long as all connections are preserved between all inputs, outputs, and generators of the diagram, the spatial position and orientation of each generator can be varied, and wires are free to cross or bend as they please.
The Z and X generators are symmetric with respect to swapping two inputs, while the Z, X, and W generators are symmetric with respect to swapping two outputs:
\begin{equation}
  \scalebox{0.9}{\tikzfig{tikz/axioms/wsymetrydit}}
  \tag{Sym}\label{rule:Sym}
\end{equation}
However, unlike the Z and X generators, the W generator is not symmetric with respect to swapping an input and an output due to the following:
\begin{equation}
  \scalebox{0.9}{\tikzfig{tikz/axioms/w-asym}}
  \tag{Asym}\label{rule:Asym}
\end{equation}
For this reason, care must be taken that exactly one wire of each W generator is unambiguously its exactly one input, drawn aligned with one point of the triangle.

The complete rule set of the qubit ZXW-calculus from Ref.~\cite{poor2023completeness}, and our new rules for controlled states and controlled square matrices, are presented in Figure \ref{fig:zxw_rules}. Several important lemmas are found in Appendix \ref{sec:applem}.

\input{sections/zxw_rules}

\subsection{Controlled Diagrams}

Following \cite{shaikh2022sum}, we cover the definitions of controlled states and controlled square matrices, and arithmetic on them.
Note that this is a different definition of controlled states to Ref.~\cite{jeandel2024adddiffzx} in which controlling on $\ket{0}$ is $\ket{+}^{\otimes n}$ instead of $\ket{0}^{\otimes n}$; this choice appears to make a substantial difference in the algebraic properties, which we discuss in Remark~\ref{remark:entrywise}.

\begin{definition}\label{def:ctrlsqmat}
  For an arbitrary $n \times n$ matrix $M$, we define the controlled matrix of $M$ as the diagram $\tilde{M}$ with the following interpretation:
\begin{equation}
  \left\llbracket \quad \tikzfig{tikz/con/c_sq_def} \;\;\; \right\rrbracket ~=~ \bra{0} \otimes I + \bra{1} \otimes M ~=~ \begin{bmatrix} I & M \end{bmatrix} 
\end{equation}
\end{definition}

We represent the additional dimension of $\tilde{M}$ as a vertical wire to distinguish it as the control wire. Controlled matrices satisfy the two equations:

\begin{equation*}
    \tikzfig{tikz/con/c_sq0}
    \tag{\ref{rule:c_sq0}}
\end{equation*}
\begin{equation}
    \tikzfig{tikz/con/c_sq1}
\end{equation}

We define controlled states similarly.
\begin{definition}
  For an arbitrary $n$-qubit state $\psi$, the controlled state of $\psi$ is the diagram with the following interpretation:
  
  \[
 \left\llbracket \;\;\; \tikzfig{tikz/con/c_state_def} \;\;\; \right\rrbracket ~=~ \left[ \begin{array}{cc|cc} \cline{2-3} \; 1 \; & & & \\ \; 0 \; & & & \\ \; \vdots \; & \multicolumn{2}{c}{\psi} \\ & \multicolumn{2}{c}{} \\ \; 0 \; & & \\ \cline{2-3} \end{array} \right]
 \]

\end{definition}

Controlled states satisfy the equations:
  \begin{equation*}
    \tikzfig{tikz/con/c_state0}
    \tag{\ref{rule:cstate0}}
  \end{equation*}
  \begin{equation}
    \tikzfig{tikz/con/c_state1}
    \label{eq:cstate1}
  \end{equation}

\begin{prop}[Propositions 3.3 and 3.4 of \cite{shaikh2022sum}]\label{prop:cmat_ops}
    Given controlled matrices $\tilde{M_1}, ..., \tilde{M_k}$ and $c_1, ..., c_k \in \mathbb{C}$, the controlled square matrices $\widetilde{\Pi_i M_i}$ and $\widetilde{\Sigma_i c_i M_i}$ are respectively given by
    \begin{equation}
      \tikzfig{tikz/con/csq_prod}\qquad\qquad\qquad\qquad\tikzfig{tikz/con/csq_sum}
    \end{equation}
\end{prop}

The addition and multiplication of controlled states are defined similarly to controlled matrix arithmetic, except that a layer of $\lowerbox{\coW}$s are appended at the bottom to preserve the number of outputs.
The role of $\lowerbox{\coW}$ is to \textit{copy} controlled diagrams, as we will show in Section~\ref{sec:ring}.

\begin{prop}
  Given controlled states $\tilde{\psi}$ and $\tilde{\phi}$, we define addition $\tilde{\psi} \boxplus \tilde{\phi}$ and multiplication $\tilde{\psi} \boxtimes \tilde{\phi}$ operations on them to result in the controlled states:
  \begin{equation}
    \tikzfig{tikz/con/cs_add_def} \qquad\qquad\qquad\qquad \tikzfig{tikz/con/cs_times_def}
\end{equation}
\end{prop}
\begin{remark}
  Ref.~\cite{shaikh2022sum} defined this addition with red spiders at the bottom instead of $\lowerbox{\coW}$s; the linear map is the same, being $\widetilde{\phi + \psi}$. In choosing to use $\lowerbox{\coW}$, we will soon define the arithmetic fragment of the ZW-calculus.
  
  Removing the $\lowerbox{\coW}$'s from the bottom of this multiplication gives the controlled diagram for the tensor product in Hilbert space $\widetilde{\psi \otimes \phi}$, as noted in Ref.~\cite{jeandel2024adddiffzx}.
\end{remark}
Although the interpretation of $\tilde{\psi} \boxtimes \tilde{\phi}$ is not the controlled multiplication of the linear maps $\psi$ and $\phi$, nor as nice an expression in terms of $\psi$ and $\phi$, we will show in this work that this is in fact multiplication in the ring of \emph{multilinear polynomials}.